QString path = QCoreApplication::applicationDirPath() + "/payments.txt";
QFile file(path);
if(!file.open(QIODevice::ReadOnly | QIODevice::Text)) return;

QTextStream in(&file);
QStringList lines;
while(!in.atEnd()){
    QString line = in.readLine();
    QStringList parts = line.split(",");
    if(parts.size() == 4 && parts[0].toInt() == session::userId && parts[1] == selectedPaymentId){
        parts[3] = "Paid"; // ستون وضعیت
        lines.append(parts.join(","));
    } else {
        lines.append(line);
    }
}
file.close();

if(!file.open(QIODevice::WriteOnly | QIODevice::Text)) return;
QTextStream out(&file);
for(const QString &l : lines) out << l << "\n";
file.close();
